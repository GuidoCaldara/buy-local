function loadFile(event){
  var output = document.querySelector('.new-product-form-flex-container-image img');
  output.src = URL.createObjectURL(event.target.files[0]);
  output.onload = function() {
    URL.revokeObjectURL(output.src) // free memory
  }
}


function initPhotoPreview(){
  const input = document.querySelector("#product_photo")
  if (input){
    input.addEventListener("change", loadFile);
  }
}

function replaceProduct(productCard){
  const cardToReplace = document.querySelector('[data-product-id="<%= @product.id%>"]')
  cardToReplace.insertAdjacentHTML('beforebegin', productCard)
  cardToReplace.remove()
}

function dislpayErrors(form){
  const formContainer = document.querySelector('.store-dashboard-modal-body')
  formContainer.innerHTML = form
}

function closeModal(){
  document.querySelector('.store-dashboard-modal-background').remove()
}

<% if @product.errors.any? %>
  dislpayErrors("<%= j render 'shop/products/form', product: @product %>")
<% else %>
  closeModal()
  replaceProduct("<%= j render 'shop/products/product', product: @product %>")
<% end%>
